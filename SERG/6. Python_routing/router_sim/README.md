# RouterSim

Минимальный пример динамической маршрутизации между ≥6 узлами с возможностью:

- задавать метрики линков и их состояние (up/down);
- автоматически пересчитывать таблицы маршрутизации (алгоритм Дейкстры);
- отправлять «пакет» от узла A к узлу B с детальным логом пересылки на каждом хопе;
- демонстрировать альтернативные маршруты при изменении метрик/отказах.

## Структура проекта

```
router_sim/
├── main.py                 # Сценарий запуска/демо
├── network/
│   ├── link.py             # Класс Link — двунаправленная связь между двумя роутерами
│   ├── packet.py           # Класс Packet — упрощённый сетевой пакет (src,dst,payload,ttl)
│   ├── router.py           # Класс Router — интерфейсы, таблица маршрутизации, форвардинг
│   └── topology.py         # Класс Topology — сборка топологии, отправка пакетов, операции
└── README.md
```

## Как запустить

1. Убедитесь, что установлен Python 3.9+.

2. Перейдите в директорию проекта:
   
   ```bash
   cd router_sim
   ```

3. Запустите демонстрационный сценарий:
   
   ```bash
   python main.py
   ```

Вы увидите:

- снимки таблиц маршрутизации на всех узлах;
- лог доставки пакета A→F по кратчайшему пути;
- изменение метрики на канале B–E (до 50), перерасчёт таблиц и повторную отправку A→F по **другому** маршруту;
- отказ канала C–F (down), перерасчёт и отправку A→G (по A–D–G и т.д.).

## Как это работает (кратко про классы)

### `network.Link`

- Соединяет два роутера (двунаправленно).
- Имеет `metric` (стоимость) и флаг `up` (состояние линии).
- Позволяет менять метрику и состояние: `set_metric()`, `set_state()`.

### `network.Router`

- Хранит список интерфейсов (имя, IP, связанный `Link`).

- Метод `compute_routes()` запускает Дейкстру по графу «роутер—линк—роутер» и строит `routing_table`:
  
  ```py
  {destination_name: Route(next_hop, cost, path=[...])}
  ```

- Метод `forward(packet, all_routers, log)` реализует пересылку: ищет маршрут, уменьшает TTL, логирует переход и передаёт пакет соседу.

### `network.Topology`

- Содержит словарь роутеров и список линков.
- `Topology.sample()` строит пример с узлами **A..G** и несколькими альтернативными путями.
- `send(src, dst, payload)` — отправка пакета с пошаговым логом.
- `set_link_metric(a,b,val)` и `set_link_state(a,b,up)` — динамические изменения с автоматическим пересчётом маршрутов.
- `routing_tables_snapshot()` — удобный дамп таблиц для печати/проверок.

### `network.Packet`

- Упрощённая модель пакета (источник/получатель — имена роутеров), полезная нагрузка и TTL.

# Пример работы

```bash

```
